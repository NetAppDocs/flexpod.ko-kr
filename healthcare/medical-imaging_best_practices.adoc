---
sidebar: sidebar 
permalink: healthcare/medical-imaging_best_practices.html 
keywords: secure, multitenancy, availability, storage, best, practices, san, boot, efficiency, thin, provisioning,, service, quality, medical, imaging 
summary: 이 섹션에서는 NetApp FlexPod Express 스토리지 클러스터 설계의 모범 사례를 다룹니다. 
---
= 모범 사례
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/




== 스토리지 모범 사례



=== 고가용성

NetApp 스토리지 클러스터 설계는 모든 레벨에서 고가용성을 제공합니다.

* 클러스터 노드
* 백엔드 스토리지 접속 구성
* 3가지 디스크 장애를 지원할 수 있는 RAID TEC
* 2개의 디스크 장애를 감당할 수 있는 RAID DP
* 각 노드에서 2개의 물리적 네트워크에 대한 물리적 연결
* 스토리지 LUN 및 볼륨에 대한 다중 데이터 경로




=== 보안 멀티 테넌시

NetApp SVM(스토리지 가상 시스템)은 보안 도메인, 정책 및 가상 네트워킹을 분리하기 위해 가상 스토리지 어레이를 제공합니다. NetApp은 스토리지 클러스터에서 데이터를 호스팅하는 각 테넌트 조직에 대해 별도의 SVM을 생성할 것을 권장합니다.



=== NetApp 스토리지 모범 사례

다음과 같은 NetApp 스토리지 모범 사례를 고려해 보십시오.

* NetApp AutoSupport 기술을 항상 사용하도록 설정하십시오. 그러면 HTTPS를 통해 지원 요약 정보가 NetApp에 전송됩니다.
* 가용성과 이동성을 최대화하기 위해 NetApp ONTAP 클러스터의 각 노드에서 SVM용으로 LIF를 생성해야 합니다. ALUA(Asymmetric Logical Unit Access)는 경로를 구문 분석하고 활성 최적화(직접) 경로와 최적화되지 않은 활성 경로를 식별하는 데 사용됩니다. ALUA는 FC 또는 FCoE 및 iSCSI 모두에 사용됩니다.
* LUN만 포함된 볼륨은 내부적으로 마운트할 필요가 없으며 접합 경로가 필요하지 않습니다.
* 대상 인증을 위해 ESXi에서 CHAP(Challenge-Handshake Authentication Protocol)를 사용하는 경우 ONTAP에서도 구성해야 합니다. CLI('vserver iSCSI security create') 또는 NetApp ONTAP System Manager(스토리지 > SVM > SVM 설정 > 프로토콜 > iSCSI에서 이니시에이터 보안 편집)를 사용하십시오.




=== SAN 부팅

FlexPod 데이터 센터 솔루션에서 Cisco UCS 서버용 SAN 부팅을 구축하는 것이 좋습니다. 이 단계를 통해 운영 체제를 NetApp AFF 스토리지 시스템으로 안전하게 보호하면서 더 나은 성능을 제공할 수 있습니다. 이 솔루션에 요약된 설계는 iSCSI SAN 부팅을 사용합니다.

iSCSI SAN 부팅에서 각 Cisco UCS 서버에는 스토리지에 대한 이중 연결을 제공하는 2개의 iSCSI vNIC(각 SAN 패브릭당 1개)가 할당됩니다. 이 예의 스토리지 포트인 e2a와 E2E는 Cisco Nexus 스위치에 연결되어 함께 그룹화하여 인터페이스 그룹(ifgrp)이라는 하나의 논리 포트(이 예에서는 a0a)를 구성합니다. iSCSI VLAN은 igroup에 생성되고 iSCSI LIF는 iSCSI 포트 그룹(이 예에서는 a0a-<iSCSI-A-VLAN>)에 생성됩니다. iSCSI 부트 LUN은 igroup을 사용하여 iSCSI LIF를 통해 서버에 노출됩니다. 이렇게 하면 권한이 있는 서버만 부팅 LUN에 액세스할 수 있습니다. 포트 및 LIF 레이아웃에 대한 자세한 내용은 아래 그림을 참조하십시오.

image:medical-imaging_image8.png["오류: 그래픽 이미지가 없습니다"]

NAS 네트워크 인터페이스와 달리 SAN 네트워크 인터페이스는 장애 발생 시 페일오버되도록 구성되지 않습니다. 대신, 네트워크 인터페이스를 사용할 수 없게 되면 호스트는 사용 가능한 네트워크 인터페이스에 대해 최적화된 새 경로를 선택합니다. NetApp에서 지원하는 표준인 ALUA는 호스트가 최상의 스토리지 경로를 식별할 수 있도록 SCSI 타겟에 대한 정보를 제공합니다.



=== 스토리지 효율성 및 씬 프로비저닝

NetApp은 운영 워크로드를 위한 최초의 중복제거 기능과 인라인 데이터 컴팩션을 통해 압축을 강화하고 작은 파일 및 I/O를 효율적으로 저장하는 등 스토리지 효율성 혁신에 있어 업계를 선도하고 있습니다. ONTAP는 인라인 및 백그라운드 중복제거와 인라인 및 백그라운드 압축을 모두 지원합니다.

블록 환경에서 중복 제거의 이점을 실현하려면 LUN이 씬 프로비저닝되어야 합니다. LUN이 여전히 VM 관리자가 프로비저닝된 용량을 차지하는 것으로 보이더라도 중복 제거 절약 효과가 다른 요구에 사용될 볼륨으로 반환됩니다. 이러한 LUN을 LUN 크기의 2배에 달하는 용량으로 씬 프로비저닝된 FlexVol 볼륨에 구축하는 것이 좋습니다. 이러한 방식으로 LUN을 구축하면 FlexVol 볼륨이 할당량만 됩니다. LUN이 사용하는 스토리지가 FlexVol 볼륨과 포함된 애그리게이트에 보고됩니다.

중복제거를 최대한 절약하거나, 백그라운드 중복제거를 예약하는 것이 좋습니다. 그러나 이러한 프로세스는 실행 중일 때 시스템 리소스를 사용합니다. 따라서 가장 좋은 방법은 자주 사용하지 않는 시간(예: 주말)에 일정을 세우거나 자주 실행하여 변경된 데이터 처리 횟수를 줄이는 것입니다. AFF 시스템의 자동 백그라운드 중복제거는 전경 작업에 미치는 영향을 훨씬 덜 줍니다. 백그라운드 압축(하드 디스크 기반 시스템의 경우)도 리소스를 사용하므로 성능 요구사항이 제한적인 2차 워크로드에만 사용해야 합니다.



=== 서비스 품질

ONTAP 소프트웨어를 실행하는 시스템에서는 ONTAP 스토리지 QoS 기능을 사용하여 초당 메가비트(MBps) 단위의 처리량을 제한하고 파일, LUN, 볼륨 또는 전체 SVM과 같은 서로 다른 스토리지 개체에 대한 IOPS를 제한할 수 있습니다. 적응형 QoS는 데이터 저장소 용량 및 사용된 공간에 따라 동적으로 조정되는 IOPS 바닥(QoS 최소) 및 상한(QoS 최대)을 설정하는 데 사용됩니다.

처리량 제한은 다른 워크로드에 영향을 주지 않는지 확인하기 위해 배포 전에 알 수 없거나 테스트 워크로드를 제어하는 데 유용합니다. 또한 이러한 제한을 사용하여 제한된 워크로드가 확인된 후에 이를 제한할 수도 있습니다. ONTAP의 SAN 오브젝트에 일관된 성능을 제공하기 위해 IOPS를 기반으로 하는 최소 서비스 레벨도 지원됩니다.

NFS 데이터 저장소를 사용하면 QoS 정책을 전체 FlexVol 볼륨 또는 해당 볼륨 내의 개별 가상 머신 디스크(VMDK) 파일에 적용할 수 있습니다. ONTAP LUN을 사용하는 VMFS 데이터 저장소(Hyper-V의 클러스터 공유 볼륨[CSV])에서는 LUN이 포함된 FlexVol 볼륨 또는 개별 LUN에 QoS 정책을 적용할 수 있습니다. 하지만 ONTAP는 VMFS를 인식할 수 없기 때문에 개별 VMDK 파일에 QoS 정책을 적용할 수 없습니다. VSC 7.1 이상과 함께 VMware 가상 볼륨(VVol)을 사용하면 스토리지 기능 프로필을 사용하여 개별 VM에서 최대 QoS를 설정할 수 있습니다.

VMFS 또는 CSV를 비롯한 LUN에 QoS 정책을 할당하려면 VSC 홈 페이지의 스토리지 시스템 메뉴에서 ONTAP SVM('Vserver'으로 표시됨), LUN 경로 및 일련 번호를 확인할 수 있습니다. 스토리지 시스템(SVM)을 선택한 다음 Related Objects > SAN을 선택합니다. ONTAP 툴 중 하나를 사용하여 QoS를 지정할 때 이 접근 방식을 사용합니다.

오브젝트에 대한 QoS 최대 처리량 제한을 Mbps 단위로, IOPS 단위로 설정할 수 있습니다. 둘 다 사용하는 경우 첫 번째 제한에 도달하면 ONTAP에서 적용됩니다. 워크로드에는 여러 개체가 포함될 수 있으며 QoS 정책을 하나 이상의 워크로드에 적용할 수 있습니다. 여러 워크로드에 정책을 적용하면 워크로드에서는 정책의 총 한도를 공유합니다. 중첩된 개체는 지원되지 않습니다(예: 볼륨 내의 파일의 경우 각 개체는 고유한 정책을 가질 수 없음). QoS 최소값을 IOPS에서만 설정할 수 있습니다.



=== 스토리지 레이아웃

이 섹션에서는 스토리지의 LUN, 볼륨 및 애그리게이트 레이아웃에 대한 모범 사례를 설명합니다.



==== 스토리지 LUN

최적의 성능, 관리 및 백업을 위해 NetApp은 다음과 같은 LUN 설계 모범 사례를 권장합니다.

* 데이터베이스 데이터와 로그 파일을 저장할 별도의 LUN을 생성합니다.
* Oracle 데이터베이스 로그 백업을 저장할 각 인스턴스에 대해 별도의 LUN을 생성합니다. LUN은 동일한 볼륨의 일부일 수 있습니다.
* 데이터베이스 파일 및 로그 파일에 대한 씬 프로비저닝(공간 예약 옵션 사용 안 함)으로 LUN을 프로비저닝합니다.
* 모든 이미징 데이터는 FC LUN에 호스팅됩니다. FlexVol 볼륨에서 서로 다른 스토리지 컨트롤러 노드가 소유한 Aggregate에 분산되는 LUN을 생성합니다.


스토리지 볼륨에 LUN을 배치하려면 다음 섹션의 지침을 따르십시오.



==== 스토리지 볼륨

최적의 성능, 관리 및 백업 작업을 위해 NetApp은 다음과 같은 볼륨 설계 모범 사례를 권장합니다.

* 하루 종일 다양한 볼륨에 I/O 집약적 쿼리를 사용하여 데이터베이스를 격리하고 최종적으로 데이터베이스를 백업할 별도의 작업을 가집니다.
* 빠른 복구를 위해서는 최소 복구 시간 목표(RTO)가 있는 대규모 데이터베이스와 데이터베이스를 별도의 볼륨에 배치하십시오.
* 중요도가 덜하거나 I/O 요구사항이 적은 중소 규모의 데이터베이스를 단일 볼륨으로 통합합니다. 동일한 볼륨에 상주하는 많은 데이터베이스를 백업할 경우 더 적은 수의 스냅샷 복사본을 유지해야 합니다. 또한 Oracle 데이터베이스 서버 인스턴스를 통합하여 동일한 볼륨을 사용하여 생성한 백업 Snapshot 복사본 수를 제어할 것을 권장합니다.
* 데이터베이스 복제본의 경우 모든 노드의 동일한 폴더 구조에 복제본에 대한 데이터 및 로그 파일을 배치합니다.
* 데이터베이스 파일을 단일 FlexVol에 배치하고 FlexVol에 분산하지 마십시오.
* 공간 부족 상태를 방지하기 위해 필요한 경우 볼륨 자동 크기 정책을 구성합니다.
* 데이터베이스 I/O 프로필이 주로 의사 결정 지원 시스템 워크로드와 같은 대규모 순차 읽기로 구성된 경우 볼륨에 대한 읽기 재할당을 활성화합니다. 읽기 재할당은 성능 향상을 위해 블록을 최적화합니다.
* 운영 관점에서 쉽게 모니터링하려면 볼륨의 스냅샷 복사본 예약 공간 값을 0으로 설정합니다.
* 스토리지 Snapshot 복사본 일정 및 보존 정책을 사용하지 않도록 설정합니다. 대신 Oracle 데이터베이스용 NetApp SnapCenter 플러그인을 사용하여 Oracle 데이터 볼륨의 스냅샷 복사본을 조정할 수 있습니다.
* 사용자 데이터 파일과 로그 파일을 별도의 FlexVol에 배치하여 각 FlexVol에 적절한 QoS를 구성하고 다른 백업 일정을 생성할 수 있도록 합니다.




==== 애그리게이트

Aggregate는 NetApp 스토리지 구성의 운영 스토리지 컨테이너로, 데이터 디스크와 패리티 디스크로 구성된 하나 이상의 RAID 그룹을 포함합니다.

NetApp은 데이터 파일과 트랜잭션 로그 파일을 분리한 상태로 공유 및 전용 애그리게이트를 사용하여 다양한 I/O 워크로드 특성 테스트를 수행했습니다. 테스트 결과, RAID 그룹 및 드라이브(HDD 또는 SSD)가 더 많은 대형 Aggregate가 스토리지 성능을 최적화 및 개선하고 관리자가 다음과 같은 두 가지 이유로 더 쉽게 관리할 수 있는 것으로 나타났습니다.

* 하나의 대형 Aggregate는 모든 드라이브에서 I/O 기능을 모든 파일에 사용할 수 있도록 합니다.
* 하나의 대형 Aggregate는 디스크 공간을 가장 효율적으로 사용합니다.


효과적인 재해 복구를 위해 재해 복구 사이트에서 별도의 스토리지 클러스터의 일부인 애그리게이트에 비동기식 복제본을 배치하고 SnapMirror 기술을 사용하여 콘텐츠를 복제하는 것이 좋습니다.

최적의 스토리지 성능을 위해 aggregate에서 사용 가능한 공간을 10% 이상 확보하는 것이 좋습니다.

AFF A300 시스템(드라이브 24개가 포함된 디스크 쉘프 2개)에 대한 스토리지 애그리게이트 레이아웃 지침은 다음과 같습니다.

* 스페어 드라이브 2개를 보관합니다.
* 고급 디스크 파티셔닝을 사용하여 각 드라이브에 3개의 파티션, 즉 루트와 데이터를 작성하십시오.
* 각 애그리게이트에 총 20개의 데이터 파티션과 2개의 패리티 파티션을 사용합니다.




=== 백업 Best Practice

NetApp SnapCenter는 VM 및 데이터베이스 백업에 사용됩니다. 권장되는 백업 모범 사례는 다음과 같습니다.

* 백업을 위한 스냅샷 복사본을 생성하기 위해 SnapCenter를 구축한 경우 VM 및 애플리케이션 데이터를 호스팅하는 FlexVol의 스냅샷 스케줄을 끄십시오.
* 호스트 부팅 LUN을 위한 전용 FlexVol를 생성합니다.
* 같은 용도로 사용되는 VM에 대해 유사하거나 단일 백업 정책을 사용합니다.
* 워크로드 유형별로 비슷하거나 단일 백업 정책을 사용하십시오. 예를 들어, 모든 데이터베이스 워크로드에 비슷한 정책을 사용하십시오. 데이터베이스, 웹 서버, 최종 사용자 가상 데스크톱 등에 대해 서로 다른 정책을 사용합니다.
* SnapCenter에서 백업 확인을 활성화합니다.
* NetApp SnapVault 백업 솔루션에 백업 Snapshot 복사본 아카이브를 구성합니다.
* 아카이브 일정에 따라 운영 스토리지에 백업 보존을 구성합니다.




== 인프라 모범 사례



=== 네트워킹 모범 사례

NetApp에서는 다음과 같은 네트워킹 모범 사례를 권장합니다.

* 시스템에 운영 및 스토리지 트래픽을 위한 이중화된 물리적 NIC가 포함되어 있는지 확인합니다.
* 컴퓨팅과 스토리지 간의 iSCSI, NFS 및 SMB/CIFS 트래픽에 대해 별도의 VLAN을 사용합니다.
* 시스템에 의료용 영상 시스템에 대한 클라이언트 액세스를 위한 전용 VLAN이 포함되어 있는지 확인하십시오.


FlexPod 인프라 설계 및 구축 가이드에서 추가 네트워킹 모범 사례를 확인할 수 있습니다.



=== 컴퓨팅 모범 사례

NetApp에서는 다음과 같은 컴퓨팅 모범 사례를 따르는 것이 좋습니다.

* 지정된 각 vCPU가 물리적 코어에서 지원되는지 확인합니다.




=== 가상화 모범 사례

권장되는 가상화 모범 사례는 다음과 같습니다.

* VMware vSphere 6 이상을 사용합니다.
* ESXi 호스트 서버 BIOS 및 OS 계층을 Custom Controlled – High Performance로 설정합니다.
* 사용량이 적은 시간에 백업을 생성합니다.




== 의료 영상 시스템 모범 사례

일반적인 의료 영상 시스템의 다음 모범 사례와 일부 요구 사항을 참조하십시오.

* 가상 메모리를 오버 커밋하지 마십시오.
* 총 vCPU 수가 물리적 CPU 수와 같은지 확인합니다.
* 대규모 환경인 경우 전용 VLAN이 필요합니다.
* 전용 HA 클러스터를 사용하여 데이터베이스 VM 구성
* VM OS VMDK가 고속 계층 1 스토리지에 호스팅되는지 확인합니다.
* 의료 영상 시스템 공급업체와 협력하여 신속한 배포 및 유지 관리를 위해 VM 템플릿을 준비하는 가장 좋은 방법을 파악합니다.
* 관리, 스토리지 및 운영 네트워크에서는 데이터베이스에 대한 LAN 분리가 필요하며, VMware vMotion에 대해 격리된 VLAN이 있어야 합니다.
* 라는 NetApp 스토리지 어레이 기반 복제 기술을 사용합니다 https://www.netapp.com/us/media/tr-4015.pdf["SnapMirror를 참조하십시오"^] vSphere 기반 복제 대신,
* VMware API를 활용하는 백업 기술을 사용합니다. 백업 윈도우는 일반 운영 시간을 벗어나야 합니다.

